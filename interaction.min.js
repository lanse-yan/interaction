/**
  * 支持至少2级联动。
*/
!function(a){a.fn.scrollerD=function(b){if(this.length){b=a.extend({},a.scrollerD.defaults,b);var d,g,c=this,h=[1,1],i=[],j=[0,0],k=[],l=[],m={},n=2;m.init=function(){g=b.itemHeigth,n=b.data.length,m.reset(l,n,g),m.createWrap(),d=c.find(".wrapper"),d.width(100/n+"%"),m.createUI(b.data[0],d.eq(0),0);for(var e=1;n>e;e++)m.createUI(b.data[e][i[e-1]],d.eq(e),e);c.on("touchmove",function(a){a.preventDefault()}),d.swipeUp(m.swipeUp),d.swipeDown(m.swipeDown),a(b.confirm).on("click",m.confirmHanlder)},m.animateTransform=function(a,b){var c={transform:"translate3d(0, "+b+"px, 0)","-webkit-transform":"translate3d(0, "+b+"px, 0)"};a.css(c)},m.createWrap=function(){var b,a=['<div class="selected bboth"></div><div class="header"><span id="confirm">确定</span></div>'];for(b=0;n>b;b++)a.push('<div class="wrapper"><div class="scroller"></div></div>');c.append(a.join(""))},m.createUI=function(b,c,d){var f,e=c.find(".scroller");e.empty(),b&&(f=a("<ul>"),a.each(b,function(a,b){f.append("<li data-id="+a+">"+b+"</li>")}),e.append(f),m.getBoundary(e.find("li").length,d))},m.swipeUp=function(){var d,c=a(".wrapper").index(this);j[c]!==k[c]&&(j[c]=j[c]-g,j[c]<k[c]&&(j[c]=k[c]),m.animateTransform(a(this).find(".scroller"),j[c]),h[c]=h[c]+1,d=a(this).find("li").removeClass("active").eq(h[c]).addClass("active").attr("data-id"),c+1!==n&&m.updateSubEle(d,c),i[c]=d)},m.swipeDown=function(){var d,c=a(".wrapper").index(this);j[c]!==l[c]&&(j[c]=j[c]+g,j[c]>l[c]&&(j[c]=l[c]),m.animateTransform(a(this).find(".scroller"),j[c]),h[c]=h[c]-1,d=a(this).find("li").removeClass("active").eq(h[c]).addClass("active").attr("data-id"),c+1!==n&&m.updateSubEle(d,c),i[c]=d)},m.updateSubEle=function(a,c){m.createUI(b.data[c+1][a],d.eq(c+1),c+1)},m.confirmHanlder=function(){var d,c="";for(d=0;n>d;d++){if(!i[d])return c;c+=0===d?b.data[d][i[0]]:" "+b.data[d][i[d-1]][i[d]]}b.confirmHandler(c),a(" body").removeClass("stshow")},m.getBoundary=function(a,c){var e,f,o;switch(a){case 0:m.reset(l,n,0,c),m.reset(k,n,0,c),m.reset(i,n,void 0,c),m.reset(h,n,void 0,c);break;case 1:e=d.eq(c),k[c]=g,i[c]=e.find(".scroller").eq(0).attr("data-id"),m.animateTransform(e.find(".scroller"),g),e.find("li").addClass("active"),j[c]=g,h[c]=0;break;default:f=1,o="",e=d.eq(c),k[c]=-1*g*(e.find("li").length-2),b.initData&&b.initData[c]?(f=e.find('li[data-id="'+b.initData[c]+'"]').addClass("active").index(),o=b.initData[c]):o=e.find("li").eq(1).addClass("active").attr("data-id"),i[c]=o,h[c]=f,j[c]=-1*(f-1)*g,m.animateTransform(e.find(".scroller"),j[c]),b.initData[c]=void 0}},m.reset=function(a,b,c,d){d=d||0;for(var e=d;b>e;e++)a[e]=c},m.init(),b.isShow&&a("body").addClass("stshow"),a(b.trigger).on("click",function(){a("body").addClass("stshow")}),a(b.mask).on("click",function(){a("body").removeClass("stshow")}),a("#confirm").on("click",function(){})}},a.scrollerD={defaults:{selector:["#wraSub"],itemHeigth:40,data:{},subData:{},confirm:"#confirm",isShow:!0,trigger:"#inter",mask:".mask",confirmHandler:function(){}}}}(Zepto);